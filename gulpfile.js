'use strict';

var gulp = require('gulp'),
    nodemon = require('gulp-nodemon'),
    jshint = require('gulp-jshint');

/*******************************************************************************
* FILE PATHS
*******************************************************************************/

var files = {
  javascript: [
    './lib/**/*.js',
    './config/**/*.js',
    './gulpfile.js',
    './index.js'
  ]
};


/*******************************************************************************
* HELPER FUNCTIONS
*******************************************************************************/
function clearConsole() {
    var lines = process.stdout.getWindowSize()[1];
    for(var i = 0; i < lines; i+=1) {
        console.log('\r\n');
    }
}

/*******************************************************************************
* LINT TASK
*******************************************************************************/

gulp.task('lint', function () {
  gulp.src(files.javascript)
    .pipe(jshint())
    .pipe(jshint.reporter('jshint-stylish'));
});


/*******************************************************************************
* GULP WATCH
*******************************************************************************/
gulp.task('watch', function() {
  gulp.watch(files.javascript, function() {
    clearConsole();
    gulp.start('lint');
  });
});


/*******************************************************************************
* NODEMON TASK
*******************************************************************************/

gulp.task('nodemon', function () {
  nodemon({
    script: 'index.js',
    ext: 'html js'
  });
});


/*******************************************************************************
* GULP DEFAULT TASK
*******************************************************************************/

gulp.task('default', ['lint']);


/*******************************************************************************
* GULP DEVELOP TASK
*******************************************************************************/

gulp.task('develop', ['watch', 'nodemon']);
